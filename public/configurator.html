<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D-Konfigurator â€“ UNBREAK ONE</title>
    <meta name="description" content="Gestalten Sie Ihren individuellen UNBREAK ONE Weinglashalter im 3D-Konfigurator.">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/animations.css">
    <link rel="stylesheet" href="/i18n.css">
    <link rel="stylesheet" href="/configurator/configurator.css">

    <!-- i18n System with translations -->
    <script src="/i18n.js?v=2.0.6"></script>
    <script src="/language-switch.js?v=2.0.6" defer></script>
    
    <style>
    /* Configurator Page Specific Styles */
    body {
        padding-top: 84px; /* Header height */
    }
    
    .configurator-section {
        min-height: calc(100vh - 84px);
        padding: 2rem 0 4rem;
        background: linear-gradient(135deg, #f5f7fa 0%, #e8eef5 100%);
    }
    
    .configurator-header {
        text-align: center;
        margin-bottom: 2rem;
        padding: 0 1rem;
    }
    
    .configurator-header h1 {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
        color: var(--color-graphit);
    }
    
    .configurator-header p {
        font-size: 1.125rem;
        color: var(--color-anthrazit);
        opacity: 0.8;
    }
    
    .configurator-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 1rem;
    }
    
    .iframe-wrapper {
        position: relative;
        width: 100%;
        height: 70vh;
        min-height: 600px;
        background: white;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }
    
    #configurator-iframe {
        width: 100%;
        height: 100%;
        border: none;
    }
    
    .checkout-actions {
        position: sticky;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        border-top: 1px solid #e5e7eb;
        padding: 1.5rem;
        box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.05);
        z-index: 100;
    }
    
    .checkout-actions-inner {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 1rem;
    }
    
    /* Debug Bar (hidden by default) */
    #debug-bar {
        display: none;
        position: fixed;
        top: 84px;
        left: 0;
        right: 0;
        background: #1e293b;
        color: #fff;
        padding: 8px 12px;
        z-index: 9999;
        font-family: monospace;
        font-size: 11px;
        border-bottom: 2px solid #0891b2;
    }
    
    #debug-bar.active {
        display: block;
    }
    
    @media (max-width: 768px) {
        .configurator-header h1 {
            font-size: 2rem;
        }
        
        .iframe-wrapper {
            min-height: 500px;
            height: 60vh;
        }
        
        .checkout-actions {
            padding: 1rem;
        }
    }
    </style>
</head>

<body>
    <!-- Debug Bar (only visible with ?debug=1) -->
    <div id="debug-bar">
        <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">
            <strong style="color: #0891b2;">ðŸ”§ DEBUG MODE</strong>
            <span id="debug-status">Loading...</span>
            <button id="debug-panel-toggle" style="background: #0891b2; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer;">Toggle Panel (Ctrl+Shift+D)</button>
        </div>
    </div>

    <!-- Header / Navigation -->
    <header>
        <nav>
            <div class="logo">
                <a href="index.html" class="logo-link">
                    <img src="images/logo.png" alt="UNBREAK ONE" class="nav-logo">
                </a>
            </div>

            <div class="burger-menu" id="burgerMenu">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <ul class="nav-links" id="navLinks">
                <li><a href="index.html#hero">Start</a></li>
                <li><a href="index.html#produkt">Produkt</a></li>
                <li><a href="index.html#einsatzbereiche">Einsatzbereiche</a></li>
                <li><a href="index.html#technik">Technik</a></li>
                <li><a href="configurator.html" class="active">Konfigurator</a></li>
                <li><a href="/shop">Shop</a></li>
                <li><a href="index.html#kontakt">Kontakt</a></li>
            </ul>
        </nav>
    </header>

    <!-- Configurator Section -->
    <section class="configurator-section" id="configurator">
        <div class="container">
            <div class="configurator-header">
                <h1>3D-Konfigurator</h1>
                <p>Gestalten Sie Ihren individuellen UNBREAK ONE</p>
            </div>

            <div class="configurator-container">
                <div class="iframe-wrapper">
                    <iframe 
                        id="configurator-iframe"
                        src="https://unbreak-3-d-konfigurator.vercel.app/"
                        title="UNBREAK ONE 3D Konfigurator"
                        allow="accelerometer; autoplay; encrypted-media; fullscreen; geolocation; gyroscope; payment; vr; xr-spatial-tracking"
                        loading="eager"
                        allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>
    </section>

    <!-- Sticky Checkout Actions (always visible) -->
    <div class="checkout-actions">
        <div class="checkout-actions-inner">
            <p style="margin: 0; color: var(--color-anthrazit); font-size: 0.9rem;">
                <span id="checkout-hint">WÃ¤hlen Sie Ihre Farben und klicken Sie im Konfigurator auf "In den Warenkorb"</span>
            </p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/checkout.js"></script>
    
    <!-- Bridge Communication System v2.0 -->
    <script src="/lib/bridge-schema.js?v=2.0.1"></script>
    <script src="/lib/bridge-debug.js?v=2.0.1"></script>
    <script src="/lib/bridge-debug-panel.js?v=2.0.1"></script>
    <script src="/iframe-language-bridge-v2.js?v=2.0.1"></script>
    
    <!-- Initialize Bridge & Debug -->
    <script>
    (function() {
        'use strict';
        
        // Check for debug mode
        const urlParams = new URLSearchParams(window.location.search);
        const debugMode = urlParams.get('debug') === '1';
        
        if (debugMode) {
            document.getElementById('debug-bar')?.classList.add('active');
            document.getElementById('debug-panel-toggle')?.addEventListener('click', function() {
                if (window.UnbreakBridgeDebug) {
                    // Toggle debug panel
                    const panel = document.querySelector('.bridge-debug-panel');
                    if (panel) {
                        panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                    }
                }
            });
        }
        
        // Initialize when DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
        
        function init() {
            console.log('ðŸš€ [CONFIGURATOR] Initializing...');
            
            // Enable Bridge debug if available
            if (window.UnbreakBridgeDebug) {
                window.UnbreakBridgeDebug.enable();
                console.log('âœ… [CONFIGURATOR] Bridge debug enabled');
                
                if (debugMode) {
                    document.getElementById('debug-status').textContent = 'Bridge: Ready';
                }
            }
            
            // Burger menu
            const burgerMenu = document.getElementById('burgerMenu');
            const navLinks = document.getElementById('navLinks');
            
            if (burgerMenu && navLinks) {
                burgerMenu.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                });
            }
            
            // Auto-scroll to configurator if not already there
            setTimeout(function() {
                const configuratorSection = document.getElementById('configurator');
                const rect = configuratorSection?.getBoundingClientRect();
                
                // If configurator not fully visible, scroll to it
                if (rect && rect.top > window.innerHeight * 0.2) {
                    configuratorSection.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
            }, 500);
            
            console.log('âœ… [CONFIGURATOR] Initialization complete');
        }
    })();
    </script>
</body>
</html>
